/**
 * @package Helix Ultimate Framework
 * @author JoomShaper https://www.joomshaper.com
 * @copyright Copyright (c) 2010 - 2021 JoomShaper
 * @license http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 or Later
 */
window.addEventListener("DOMContentLoaded",(()=>{void 0!==Joomla.Showon&&void 0!==Joomla.Showon.initialise&&Joomla.Showon.initialise(document)})),jQuery((function(e){"use strict";var t=Joomla.getOptions("data")||{};let i=Joomla.getOptions("meta")||{};const a=localStorage||window.localStorage;let s=null;Joomla.initColorPicker=function(t,i={}){const a={animationSpeed:50,animationEasing:"swing",control:"hue",position:"bottom",theme:"bootstrap",keywords:"transparent, initial, inherit",letterCase:"uppercase"};e(t).each((function(){e(this).minicolors({...a,...i})}))},e(".form-select[multiple]").chosen({width:"100%"});const o=()=>{let t=a.getItem("toolbarPosition")||{};t="string"==typeof t&&t.length>0&&JSON.parse(t);let i=e(".hu-container"),s=e("#hu-options-panel"),o=i.width(),n=s.width();t.left+n>o?t.left=o-n-20:t.left<0&&(t.left=20),t&&e(".hu-options-core").css({left:t.left+"px",top:t.top+"px"}),e(".hu-options-core").show()};o(),window.addEventListener("resize",o);window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let n=document.getElementById("hu-template-preview");function l(){const e=n.contentWindow.location.href;e.length&&"about:blank"!==e&&(n.src=n.getAttribute("src"))}function r(){e("#layout").val(JSON.stringify(m())),f(),e(".hu-input-preset").val(JSON.stringify(e(".hu-preset.active").data()));let t=e("#hu-style-form").find("input, select, textarea").not(".internal-use-only").serializeArray(),i=!1;e.ajax({type:"POST",url:"index.php?option=com_ajax&request=task&helix=ultimate&id="+helixUltimateStyleId+"&action=draft-tmpl-style&format=json&helix_id="+helixUltimateStyleId,data:t,beforeSend:function(){Joomla.helixLoading(!0,!1),i=!0},success:function(t){var a=e.parseJSON(t);if(a.status){let e=document.getElementById("hu-template-preview");l(),e.addEventListener("load",(function(){i&&Joomla.helixLoading(!1,a.isDrafted),i=!1}))}},error:function(e){console.error("error: Something went wrong!",e),Joomla.HelixToaster.error("Error:"+e.message,"Error")}})}function c(t){const i=e(".hu-topbar-save-spinner");t?i.hasClass("hidden")&&(i.removeClass("hidden"),i.closest(".action-save-template").find("svg").hide()):i.hasClass("hidden")||(i.addClass("hidden"),i.closest(".action-save-template").find("svg").show())}function h(e,t,i,a){a!=i&&(i=a,e.closest(".controls").attr("data-currpoint",i),e.closest(".controls").data("currpoint",i),e.closest(".controls").hasClass("helix-input-touched")||e.closest(".controls").addClass("helix-input-touched"),r()),a==t&&e.closest(".controls").hasClass("helix-input-touched")&&e.closest(".controls").removeClass("helix-input-touched")}function d({name:t,parent:i,map:a,device:s}){["","_sm","_xs"].forEach((a=>{const s=e(`input[name=${t}${a}]`).closest(i);s.hasClass("field-hidden")||s.addClass("field-hidden")}));const o=`input[name=${t}${"md"===a[s]?"":"_"+a[s]}]`;e(o).closest(i).removeClass("field-hidden")}function u(i){const a={desktop:"100%",tablet:`${t.breakpoints.tablet}px`,mobile:`${t.breakpoints.mobile}px`,md:"100%",sm:`${t.breakpoints.tablet}px`,xs:`${t.breakpoints.mobile}px`},s={md:"desktop",sm:"tablet",xs:"mobile",desktop:"desktop",tablet:"tablet",mobile:"mobile"},o={desktop:"md",tablet:"sm",mobile:"xs"},n=e("#hu-template-preview");e(`.hu-device[data-device=${s[i]}]`).parent().find(".active").removeClass("active"),e(`.hu-device[data-device=${s[i]}]`).addClass("active"),["","-sm","-xs"].forEach((t=>{e(`.hu-webfont-size-field${t}`).closest(".hu-webfont-unit").removeClass("active")})),e("input.hu-webfont-size-field"+("md"===o[i]?"":"-"+o[i])).closest(".hu-webfont-unit").addClass("active"),d({name:"header_height",parent:".group-style-header",map:o,device:i}),d({name:"logo_height",parent:".group-style-logo",map:o,device:i}),n.animate({width:a[i]},300,"linear")}function p(){let t=e(".hu-options-core"),i=e(".hu-edit-panel.active-panel"),a=e("#hu-options-panel"),s=e(".hu-container"),o=a.offset(),n=a.width(),l=i.width(),r=s.width();o.left+n+10+l>r?(t.hasClass("hu-panel-position-right")&&t.removeClass("hu-panel-position-right"),t.addClass("hu-panel-position-left")):(t.hasClass("hu-panel-position-left")&&t.removeClass("hu-panel-position-left"),t.addClass("hu-panel-position-right"))}function f(){e(".hu-field-webfont").each((function(){var t=e(this),i={fontFamily:t.find(".hu-webfont-list").val(),fontSize:t.find("[name=hu-webfont-size-field]").val(),fontSize_sm:t.find("[name=hu-webfont-size-field-sm]").val(),fontSize_xs:t.find("[name=hu-webfont-size-field-xs]").val(),fontWeight:t.find(".hu-webfont-weight-list").val(),fontStyle:t.find(".hu-webfont-style-list").val(),fontSubset:t.find(".hu-webfont-subset-list").val(),fontColor:t.find(".hu-font-color-input").val(),fontLineHeight:t.find(".hu-font-line-height-input").val(),fontLetterSpacing:t.find("[name=hu-font-letter-spacing-input]").val(),textDecoration:t.find(".hu-text-decoration").val(),textAlign:t.find(".hu-text-align").val()};t.find(".hu-webfont-input").val(JSON.stringify(i))}))}function m(){var t=[];return e("#hu-layout-builder").find(".hu-layout-section").each((function(i){var a=e(this),s=i,o=a.data();delete o.sortableItem;var n=a.find(".hu-column-layout.active").data("layout"),l=12;12!=n&&(l=n.split(",").join("")),t[s]={type:"row",layout:l,settings:o,attr:[]},a.find(".hu-layout-column").each((function(i){var a=i,o=e(this).data();delete o.sortableItem,t[s].attr[a]={type:"sp_col",settings:o}}))})),t}Joomla.reloadPreview=l,n.addEventListener("load",(function(){let e=n.contentWindow.document,i=e.querySelector(".body-innerwrapper");e.querySelectorAll("a").forEach((e=>{let t=e.getAttribute("href")||"";if("#"===t||""===t)return;let i=new URLSearchParams(new URL(e.href).search);if(i.has("helixMode"))return;i.append("helixMode","edit");let a=e.href.split("?");a[1]=i.toString(),e.setAttribute("href",a.join("?"))})),e.body.classList.add("back-panel"),i&&(i.style.marginTop=`${t.topbarHeight}px`)})),e(document).on("keyup",(function(t){if(27===t.which){if(e(".hu-megamenu-popover").hasClass("show"))return void e(".hu-megamenu-popover").removeClass("show");e("body").hasClass("hu-modal-open")&&e(document).closeModal()}})),e(document).off("keyup"),e(".reload-preview-iframe").on("click",(function(t){t.preventDefault();let i=this;l(),e(this).addClass("spin"),n.addEventListener("load",(function(){e(i).removeClass("spin")}))})),e(".hu-topbar").tooltip({classes:{"ui-tooltip":"ui-corner-all"},position:{my:"left top+8px"},hide:!1,show:!1}),e(".action-reset-drafts, .reload-preview-iframe").tooltip({classes:{"ui-tooltip":"ui-corner-all"},position:{my:"left top+10px"},hide:!1,show:!1}),Joomla.helixLoading=function(t,i){const a=e(".hu-loading-msg"),o=e(".hu-done-msg"),n=e(".action-reset-drafts");a.hide(),o.hide(),n.hide(),t?(n.hide(),o.hide(),a.show()):(a.hide(),n.hide(),o.show()),s&&clearTimeout(s),(async()=>{t||await function(e=500){return new Promise((t=>{s=setTimeout(t,e)}))}(2e3),o.hide(),i?n.show():n.hide()})()},e(".hu-menu-builder input[name=megamenu]").on("change",(function(t){t.preventDefault();const i=e(this).closest(".controls"),a=i.data("safepoint"),s=i.data("currpoint"),o=Joomla.utils.helixHash(e(this).val());h(e(this),a,s,o)})),e("form#hu-style-form").find('input[type="text"], input[type="email"], input[type="number"]').on("keydown",(function(e){13!==e.keyCode||e.preventDefault()})),e("form#hu-style-form").find('input[type="text"], input[type="email"], input[type="number"], textarea').on("blur",(function(t){t.preventDefault();let i=e(this).closest(".controls");if(!i.hasClass("field-reset")&&i.hasClass("trackable")){let t=e(this).closest(".controls").data("safepoint"),i=e(this).closest(".controls").data("currpoint"),a=e(this).val();h(e(this),t,i,a)}})),e("form#hu-style-form").find('input[type="checkbox"], input[type=color]').on("change",(function(t){t.preventDefault(),console.log("change fired!");let i=e(this).closest(".controls");if(!i.hasClass("field-reset")&&i.hasClass("trackable")){let t=e(this).closest(".controls").data("safepoint"),i=e(this).closest(".controls").data("currpoint"),a=e(this).prop("checked")?1:0;h(e(this),t,i,a)}})),e("form#hu-style-form").find('select, input[type="hidden"]').on("change",(function(t){t.preventDefault();let i=e(this).closest(".controls");if(!i.hasClass("field-reset")&&i.hasClass("trackable")){let t=e(this).closest(".controls").data("safepoint"),i=e(this).closest(".controls").data("currpoint"),a=e(this).val();h(e(this),t,i,a)}})),e(".action-reset-drafts").on("click",(function(t){t.preventDefault();e(this).hasClass("hide")||(!function(){let t=e("form#hu-style-form").find(".controls.helix-input-touched");t.length>0&&t.each(((t,i)=>{e(i).hasClass("field-reset")||e(i).addClass("field-reset")}))}(),window.confirm("Do you really want to reset your settings?")&&(e("#layout").val(JSON.stringify(m())),f(),e(".hu-input-preset").val(JSON.stringify(e(".hu-preset.active").data())),e.ajax({type:"GET",url:"index.php?option=com_ajax&request=task&helix=ultimate&id="+helixUltimateStyleId+"&action=reset-drafted-settings&format=json&helix_id="+helixUltimateStyleId,success:function(t){if(e.parseJSON(t).status){document.getElementById("hu-template-preview");l()}},error:function(e){console.error("error",e)},complete:function(){!function(){let t=e("form#hu-style-form").find(".controls.helix-input-touched.field-reset");t.length>0&&t.each((function(t,a){let s=e(a);if(s.length>0){let t=s.data("safepoint"),a=s.data("selector"),o=s.find(a);if(o.length>0){let i=void 0!==o.attr("type")&&o.attr("type").toLowerCase();if(i&&"checkbox"===i){let e=1==t;o.prop("checked",e)}"megamenu"===o.attr("name")&&e(".hu-megamenu-action-tracker").val("restore").trigger("change"),"megamenu"!==o.attr("name")&&(o.val(t),o.attr("value",t),o.change()),s.attr("data-currpoint",t),s.data("currpoint",t),"select"===o.prop("tagName").toLowerCase()&&s.find(a+"_chzn").length>0&&(o.trigger("liszt:updated"),o.trigger("chosen:updated"))}let n=s.find(".hu-image-holder img");n.length>0&&n.attr("src",`${i.base}/${t}`),s.find(".hu-header-item").each((function(){e(this).hasClass("active")&&e(this).removeClass("active"),e(this).data("style")===t&&e(this).addClass("active")})),s.removeClass("helix-input-touched"),s.removeClass("field-reset")}}))}(),Joomla.HelixToaster.success("Successfully rolled back to the previous state!","Success"),e(".hu-loading-msg").hide(),e(".hu-done-msg").hide(),e(".action-reset-drafts").hide()}})))})),e(".action-save-template").on("click",Joomla.utils.debounce((function(t){t.preventDefault();c(!0),s&&clearTimeout(s),e("#layout").val(JSON.stringify(m())),f(),e(".hu-input-preset").val(JSON.stringify(e(".hu-preset.active").data()));e(this).data("id"),e(this).data("view");const i=e("#hu-style-form").find("input, select, textarea").not(".internal-use-only").serializeArray();e.ajax({type:"POST",url:"index.php?option=com_ajax&request=task&helix=ultimate&id="+helixUltimateStyleId+"&action=save-tmpl-style&format=json&helix_id="+helixUltimateStyleId,data:i,success:function(t){var i=e.parseJSON(t);if(i.status){document.getElementById("hu-template-preview").contentWindow.location.reload(!0),Joomla.HelixToaster.success("Changes have been successfully saved!","Success"),e(".hu-loading-msg").hide(),e(".hu-done-msg").hide(),e(".action-reset-drafts").hide(),c(!1)}else Joomla.HelixToaster.error(i.message,"Failed"),e(".hu-loading-msg").hide(),e(".hu-done-msg").hide(),e(".action-reset-drafts").hide(),c(!1);!function(){let t=e("form#hu-style-form").find(".controls.helix-input-touched");t.length>0&&t.each((function(t,i){let a=e(i);if(a.length>0){let e=a.data("selector"),t=a.find(e);t.length>0&&t.attr("value",t.val()),a.attr("data-setvalue",t.val()),a.data("setvalue",t.val()),a.removeClass("helix-input-touched")}}))}()},complete(){},error:function(e){console.error("error",e),Joomla.HelixToaster.error("Error: "+e.message,"Error"),c(!1)}})}),500)),e(".hu-device").on("click",(function(t){t.preventDefault();const i=e(this).data("device");e(this).parent().find(".active").removeClass("active"),e(this).addClass("active"),u(i)})),d({name:"logo_height",parent:".group-style-logo",map:{desktop:"md",tablet:"sm",mobile:"xs"},device:"desktop"}),e("#hu-style-form").find('input[type="checkbox"]:not(.hu-menu-item-selector)').each((function(){e(this).closest(".control-group").addClass("control-group-checkbox")})),e(".hu-options-core").draggable({iframeFix:!0,cursor:"grabbing",handle:".hu-panel-handle",containment:"#helix-ultimate",drag:function(e,t){a.setItem("toolbarPosition",JSON.stringify(t.position)),p()}}),e(".hu-fieldset-header").on("click",(function(t){t.preventDefault();let i=e(this).data("fieldset");if(e("."+i+"-panel").hasClass("active-panel"))return e("."+i+"-panel").removeClass("active-panel"),void e(this).removeClass("active");e("."+i+"-panel").parent().find(".active-panel").removeClass("active-panel"),e("."+i+"-panel").addClass("active-panel"),e(this).parents("#hu-options").find(".hu-fieldset .hu-fieldset-header").hasClass("active")&&e(this).parents("#hu-options").find(".hu-fieldset .hu-fieldset-header").removeClass("active"),e(this).addClass("active"),p(),Joomla.utils.calculateSiblingDistances()})),e(".hu-panel-close").on("click",(function(t){t.preventDefault(),e(this).closest(".hu-edit-panel").hasClass("active-panel")&&e(this).closest(".hu-edit-panel").removeClass("active-panel");let i=e(`.${e(this).data("sidebarclass")} .hu-fieldset-header`);i.hasClass("active")&&i.removeClass("active")})),e(".hu-fieldset-toggle-icon").on("click",(function(t){t.preventDefault(),e(".hu-fieldset").removeClass("active"),e("#hu, #hu-options").removeClass()})),e(".hu-group-header-box").on("click",(function(t){t.preventDefault();let i=e(this).closest(".hu-edit-panel").find(".hu-group-wrap").find(".hu-field-list.active-group");if(i.length>0){i.data("uid")!==e(this).next().data("uid")&&(i.removeClass("active-group"),i.parent().removeClass("active"),i.slideUp(400))}let a=e(this).next();a.hasClass("active-group")?(e(this).parent().removeClass("active"),a.removeClass("active-group"),a.slideUp(400)):(a.addClass("active-group"),e(this).parent().addClass("active"),a.slideDown(400))})),e(".hu-header-item").on("click",(function(t){t.preventDefault();var i=e(this).closest(".hu-header-list");i.find(".hu-header-item").removeClass("active"),e(this).addClass("active");var a=e(this).data("style"),s=i.data("name");e("#"+s).val(a).trigger("change")})),e(".hu-offcanvas-item").on("click",(function(t){t.preventDefault();var i=e(this).closest(".hu-offcanvas-list");i.find(".hu-offcanvas-item").removeClass("active"),e(this).addClass("active");var a=e(this).data("style"),s=i.data("name");e("#"+s).val(a).trigger("change")})),e(document).ready((function(){"checked"==e("#custom_style").attr("checked")?e(".hu-fieldset-presets").find(".hu-group-wrap").show():e(".hu-fieldset-presets").find(".hu-group-wrap").hide()})),e(document).on("change","#custom_style",(function(t){t.preventDefault(),"checked"==e(this).attr("checked")?e(".hu-fieldset-presets").find(".hu-group-wrap").slideDown():e(".hu-fieldset-presets").find(".hu-group-wrap").slideUp()})),e(document).on("click",".hu-preset",(function(t){t.preventDefault(),e(".hu-preset").removeClass("active"),e(this).addClass("active"),r()})),e(".helix-responsive-devices span").click((function(){if(e(this).hasClass("active"))return;const t=e(this).parents(".hu-webfont-size");t.find("input").removeClass("active");const i=e(this).data("active_class");t.find(i).addClass("active"),e(this).parent().find("span.active").removeClass("active"),e(this).addClass("active");u(e(this).data("device"))})),window.purgeCss=function(t=null){e.ajax({type:"POST",url:"index.php?option=com_ajax&request=task&helix=ultimate&id="+helixUltimateStyleId+"&action=purge-css-file&format=json&helix_id="+helixUltimateStyleId,data:{},beforeSend:function(){t&&t.append('<span class="fas fa-circle-notch fa-spin" aria-hidden="true"></span>')},success:function(i){var a=e.parseJSON(i);t&&a.status&&(t.find("span").remove(),t.removeClass("disable"))},error:function(){alert("Somethings wrong, Try again")}})},e(".btn-purge-hu-css").on("click",(function(t){t.preventDefault();var i=e(this);i.hasClass("disable")||(i.addClass("disable"),window.purgeCss(i))})),e("#btn-hu-import-settings").on("click",(function(t){t.preventDefault(),e("#helix-import-file").click()})),e("#helix-import-file").on("change",(function(t){const i=new FileReader;i.onload=function(t){JSON.parse(t.target.result);var i={action:"import-tmpl-style",option:"com_ajax",helix:"ultimate",request:"task",data:{settings:t.target.result},format:"json"};return e.ajax({type:"POST",data:i,success:function(t){e.parseJSON(t).status&&window.location.reload()},complete(){Joomla.HelixToaster.success("Settings have been successfully imported!","Success")},error:function(){Joomla.HelixToaster.error("Something went wrong importing settings!","Error")}}),!1},i.readAsText(t.target.files[0])})),e(".hu-help-icon").on("click",(function(t){t.preventDefault();let i=e(this).closest(".control-group").find(".hu-control-help");e(this).toggleClass("active"),i.hasClass("show")?(i.removeClass("show"),i.slideUp(100)):(i.addClass("show"),i.slideDown(100)),e(this).closest(".control-group").siblings().each((function(){let t=e(this).find(".hu-control-help");t.hasClass("show")&&(t.removeClass("show"),t.slideUp(100))}))})),e(document).on("click",".hu-option-group-title",(function(t){t.preventDefault(),e(this).closest(".hu-option-group").toggleClass("active").siblings().removeClass("active")}));let v={};function g(){e(".hu-group-wrap").each((function(){if(e(this).attr("data-dependon")){let t=e(this).data("dependon"),[i,a]=t.split(":"),s=e(`[name=${i}]`),o=s.val();"checkbox"===s.prop("type")&&(o=s.prop("checked"),a=1==a),o==a?e(this).fadeIn(300):e(this).fadeOut(300),v[i]=s}}))}g(),Object.values(v).forEach((function(e){e.on("change",(function(e){e.preventDefault(),g()}))})),function(){let t=e(".hu-field-dimension-width"),i=e(".hu-field-dimension-height");t.on("keyup",(function(t){t.preventDefault();let i=e(this).closest(".controls").find(".hu-field-dimension-input"),a=i.val()||"0x0",s=e(this).val(),[o,n]=a.toLowerCase().split("x");""===s&&(s="0"),o=s,a=`${o}x${n}`,i.val(a)})),i.on("keyup",(function(t){t.preventDefault();let i=e(this).closest(".controls").find(".hu-field-dimension-input"),a=i.val()||"0x0",s=e(this).val(),[o,n]=a.toLowerCase().split("x");""===s&&(s="0"),n=s,a=`${o}x${n}`,i.val(a)}))}();let y=[];function w(){e(".control-group[data-enableon]").each((function(){let[t,i]=e(this).data("enableon").split(":"),a=e(`[name=${t}]`);y.push(a);let s=a.val();"checkbox"===a.prop("type")&&(s=a.prop("checked"),i=1==i),s==i?(e(this).find("input, select, textarea").prop("readonly",!1),e(this).hasClass("uneditable")&&e(this).removeClass("uneditable")):(e(this).find("input, select, textarea").prop("readonly",!0),e(this).hasClass("uneditable")||e(this).addClass("uneditable"))}))}w(),y.forEach((function(e){e.on("change",(function(){w()}))})),e(".hu-switcher .hu-action-group [hu-switcher-action]").on("click",(function(t){let i=e(this).data("value");e(this).siblings().removeClass("active"),e(this).addClass("active"),e(this).closest(".hu-switcher").find("input[type=hidden]").val(i).trigger("change");const a=t.target.closest(".hu-switcher").querySelector("input[type=hidden]");Joomla.utils.triggerEvent(a,"change")}))}));